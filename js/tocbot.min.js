var tocbot_timer;
var DEPTH_MAX = 6; // Maximum depth for expansion
var tocbot_default_config = {
    tocSelector: '.tocbot-list',
    contentSelector: '#post-content',
    headingSelector: 'h1, h2, h3, h4, h5',
    orderedList: false,
    scrollSmooth: true,
    scrollSmoothOffset: -60,
    headingsOffset: 100,
    hasInnerContainers: true,
    linkClass: 'tocbot-link',
    activeLinkClass: 'tocbot-active-link',
    listClass: 'tocbot-list',
    isCollapsedClass: 'tocbot-is-collapsed',
    collapsibleClass: 'tocbot-is-collapsible',
    hashChange: true,
};

// Initialize tocbot
document.addEventListener('DOMContentLoaded', function() {
    tocbot.init({
        ...tocbot_default_config,
        collapseDepth: 1
    });
});

// Fixed expand/collapse function
function expand_toc() {
    var b = document.querySelector('.tocbot-toc-expand');
    var expanded = b.getAttribute('data-expanded');
    
    // Destroy current tocbot
    tocbot.destroy();
    
    // Reinitialize with new depth
    tocbot.init({
        ...tocbot_default_config,
        collapseDepth: expanded ? 1 : DEPTH_MAX
    });
    
    // Toggle expanded state
    expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
    b.innerText = expanded ? 'Expand all' : 'Collapse all';
}

function go_top() {
    window.scrollTo({
        top: 0,
        behavior: 'smooth'
    });
}

function go_bottom() {
    window.scrollTo({
        top: document.body.scrollHeight,
        behavior: 'smooth'
    });
}